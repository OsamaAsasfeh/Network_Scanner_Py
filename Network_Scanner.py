import scapy.all as scapy
import optparse

def the_signature():
    print('''
                                                                                                                 
             ______   __    __        __    __             __                                        __               ______                                                                                           
 /      \ |  \  |  \      |  \  |  \           |  \                                      |  \             /      \                                                                                          
|  $$$$$$\| $$  | $$      | $$\ | $$  ______  _| $$_    __   __   __   ______    ______  | $$   __       |  $$$$$$\  _______  ______   _______   _______    ______    ______                                
| $$  | $$| $$__| $$      | $$$\| $$ /      \|   $$ \  |  \ |  \ |  \ /      \  /      \ | $$  /  \      | $$___\$$ /       \|      \ |       \ |       \  /      \  /      \                               
| $$  | $$| $$    $$      | $$$$\ $$|  $$$$$$\\$$$$$$  | $$ | $$ | $$|  $$$$$$\|  $$$$$$\| $$_/  $$       \$$    \ |  $$$$$$$ \$$$$$$\| $$$$$$$\| $$$$$$$\|  $$$$$$\|  $$$$$$\                              
| $$  | $$| $$$$$$$$      | $$\$$ $$| $$    $$ | $$ __ | $$ | $$ | $$| $$  | $$| $$   \$$| $$   $$        _\$$$$$$\| $$      /      $$| $$  | $$| $$  | $$| $$    $$| $$   \$$                              
| $$__/ $$| $$  | $$      | $$ \$$$$| $$$$$$$$ | $$|  \| $$_/ $$_/ $$| $$__/ $$| $$      | $$$$$$\       |  \__| $$| $$_____|  $$$$$$$| $$  | $$| $$  | $$| $$$$$$$$| $$                                    
 \$$    $$| $$  | $$      | $$  \$$$ \$$     \  \$$  $$ \$$   $$   $$ \$$    $$| $$      | $$  \$$\ ______\$$    $$ \$$     \\$$    $$| $$  | $$| $$  | $$ \$$     \| $$                                    
  \$$$$$$  \$$   \$$       \$$   \$$  \$$$$$$$   \$$$$   \$$$$$\$$$$   \$$$$$$  \$$       \$$   \$$|      \\$$$$$$   \$$$$$$$ \$$$$$$$ \$$   \$$ \$$   \$$  \$$$$$$$ \$$                                    
                                                                                                    \$$$$$$                                                                                                 
                                                                                                                                                                                                            
                                                                                                                                                                                                            
 __       __                  __                  __                                                                                                                             ______            __       
|  \     /  \                |  \                |  \                                                                                                                           /      \          |  \      
| $$\   /  $$  ______    ____| $$  ______        | $$____   __    __         ______    _______   ______   ______ ____    ______          ______    _______   ______    _______ |  $$$$$$\ ______  | $$____  
| $$$\ /  $$$ |      \  /      $$ /      \       | $$    \ |  \  |  \       /      \  /       \ |      \ |      \    \  |      \        |      \  /       \ |      \  /       \| $$_  \$$/      \ | $$    \ 
| $$$$\  $$$$  \$$$$$$\|  $$$$$$$|  $$$$$$\      | $$$$$$$\| $$  | $$      |  $$$$$$\|  $$$$$$$  \$$$$$$\| $$$$$$\$$$$\  \$$$$$$\        \$$$$$$\|  $$$$$$$  \$$$$$$\|  $$$$$$$| $$ \   |  $$$$$$\| $$$$$$$\
| $$\$$ $$ $$ /      $$| $$  | $$| $$    $$      | $$  | $$| $$  | $$      | $$  | $$ \$$    \  /      $$| $$ | $$ | $$ /      $$       /      $$ \$$    \  /      $$ \$$    \ | $$$$   | $$    $$| $$  | $$
| $$ \$$$| $$|  $$$$$$$| $$__| $$| $$$$$$$$      | $$__/ $$| $$__/ $$      | $$__/ $$ _\$$$$$$\|  $$$$$$$| $$ | $$ | $$|  $$$$$$$      |  $$$$$$$ _\$$$$$$\|  $$$$$$$ _\$$$$$$\| $$     | $$$$$$$$| $$  | $$
| $$  \$ | $$ \$$    $$ \$$    $$ \$$     \      | $$    $$ \$$    $$       \$$    $$|       $$ \$$    $$| $$ | $$ | $$ \$$    $$       \$$    $$|       $$ \$$    $$|       $$| $$      \$$     \| $$  | $$
 \$$      \$$  \$$$$$$$  \$$$$$$$  \$$$$$$$       \$$$$$$$  _\$$$$$$$        \$$$$$$  \$$$$$$$   \$$$$$$$ \$$  \$$  \$$  \$$$$$$$        \$$$$$$$ \$$$$$$$   \$$$$$$$ \$$$$$$$  \$$       \$$$$$$$ \$$   \$$
                                                           |  \__| $$                                                                                                                                       
                                                            \$$    $$                                                                                                                                       
                                                             \$$$$$$                                                                                                                                                                                                                                              
                                                                                                                 
                                                                                                                 \\$$$$$$                   
    ''')
def print_res(list):
    print("IP\t\t\tMac Address\n----------------------------------------------")
    for client in list:
        print(client["ip"]+"\t\t"+client["mac"])

def scan(ip):
    arp_request=scapy.ARP(pdst=ip)
    broadcast=scapy.Ether(dst="ff:ff:ff:ff:ff:ff")
    arp_request_proadcast=broadcast/arp_request
    answered_list,unanswered_list= scapy.srp(arp_request_proadcast,timeout=1,verbose=False)
    clients_list=[]

    for elemnt in answered_list:
        clients_dic={"ip":elemnt[1].psrc,"mac":elemnt[1].hwsrc}
        clients_list.append(clients_dic)
    return clients_list

def get_argumnts():
    parser=optparse.OptionParser()
    parser.add_option("-t","--target",dest="target",help="Target IP/IP range.")
    (options,arguments)=parser.parse_args()
    return options


def main():
    the_signature()
    options = get_argumnts()
    scan_result = scan(options.target)
    print_res(scan_result)

main()

